<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×”×•×¨×“×” - MasterKodi IL</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 900px; margin: 0 auto; }
        header { text-align: center; padding: 30px 0; }
        h1 { font-size: 2.5em; color: #00d9ff; margin-bottom: 10px; }
        .back-link { color: #888; text-decoration: none; }
        .back-link:hover { color: #00d9ff; }
        
        .detection-box {
            background: linear-gradient(145deg, rgba(0, 217, 255, 0.15), rgba(0, 255, 136, 0.1));
            border: 2px solid #00d9ff;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
        }
        .detection-box h2 { color: #00ff88; margin-bottom: 15px; }
        .detected-device { font-size: 1.3em; color: #fff; margin-bottom: 15px; }
        
        .download-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .download-section h2 { color: #00d9ff; margin-bottom: 20px; }
        
        .download-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }
        
        .download-card {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s;
        }
        .download-card:hover { border-color: #00d9ff; transform: translateY(-3px); }
        .download-card.recommended {
            border: 2px solid #00ff88;
            background: rgba(0, 255, 136, 0.1);
        }
        .download-card .icon { font-size: 2.5em; margin-bottom: 15px; }
        .download-card h3 { color: #fff; margin-bottom: 10px; }
        .download-card .info { color: #888; font-size: 0.9em; margin-bottom: 15px; }
        
        .download-btn {
            display: inline-block;
            background: linear-gradient(45deg, #00d9ff, #00ff88);
            color: #1a1a2e;
            padding: 12px 30px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: bold;
            margin-top: 15px;
            transition: all 0.3s;
        }
        .download-btn:hover { transform: scale(1.05); box-shadow: 0 5px 20px rgba(0, 217, 255, 0.4); }
        
        .badge {
            display: inline-block;
            background: #00ff88;
            color: #1a1a2e;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 0.8em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .device-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .device-table th, .device-table td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .device-table th { color: #00d9ff; }
        .device-table td { color: #aaa; }
        
        .downloader-code {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #00d9ff;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        .downloader-code h3 { color: #00d9ff; margin-bottom: 15px; }
        .code-display {
            font-family: monospace;
            font-size: 2em;
            color: #00ff88;
            letter-spacing: 5px;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px 30px;
            border-radius: 8px;
            display: inline-block;
        }
        .code-note { color: #888; font-size: 0.9em; margin-top: 10px; }

        .nav-buttons { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-top: 20px; }
        .nav-btn {
            background: rgba(255,255,255,0.1);
            color: #fff;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-size: 1.1em;
            transition: all 0.3s;
            border: 1px solid rgba(255,255,255,0.2);
            cursor: pointer;
        }
        .nav-btn:hover { background: rgba(0, 217, 255, 0.2); border-color: #00d9ff; }
        .nav-btn.selected { background: #00d9ff; color: #1a1a2e; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="../" class="back-link">â† ×—×–×¨×” ×œ×¢××•×“ ×”×¨××©×™</a>
            <h1>ğŸ“¥ ×”×•×¨×“×”</h1>
        </header>

        <div class="detection-box" id="detection">
            <h2>ğŸ” ×–×™×”×•×™ ××›×©×™×¨</h2>
            <div class="detected-device" id="detected-device">×‘×•×“×§...</div>
            <p id="recommendation" style="color: #aaa;"></p>
        </div>

        <div class="downloader-code">
            <h3>ğŸ“± ×§×•×“ ×œ-Downloader</h3>
            <div class="code-display">9242817</div>
            <p class="code-note">×”×§×œ×“ ×§×•×“ ×–×” ×‘××¤×œ×™×§×¦×™×™×ª Downloader ×‘×¡×˜×¨×™××¨</p>
        </div>

        <div class="nav-buttons">
            <span class="nav-btn selected" onclick="showSection('android', this)">ğŸ“± ×× ×“×¨×•××™×“</span>
            <span class="nav-btn" onclick="showSection('windows', this)">ğŸ’» Windows</span>
            <span class="nav-btn" onclick="showSection('devices', this)">ğŸ“‹ ×˜×‘×œ×ª ××›×©×™×¨×™×</span>
        </div>

        <div id="android-section" class="download-section">
            <h2>ğŸ“± ×× ×“×¨×•××™×“</h2>
            <div class="download-grid">
                <div class="download-card" id="card-64">
                    <div class="icon">ğŸ“±</div>
                    <h3>×× ×“×¨×•××™×“ 64-bit (arm64)</h3>
                    <p class="info">×œ×¨×•×‘ ×”×¡×˜×¨×™××¨×™× ×•×”×˜×œ×¤×•× ×™× ×”×—×“×©×™×</p>
                    <a href="../apk/MasterKodiIL_21.3_64bit.apk" class="download-btn">×”×•×¨×“ APK</a>
                </div>
                <div class="download-card" id="card-32">
                    <div class="icon">ğŸ“Ÿ</div>
                    <h3>×× ×“×¨×•××™×“ 32-bit (arm)</h3>
                    <p class="info">×œ××›×©×™×¨×™× ×™×©× ×™× ×™×•×ª×¨</p>
                    <a href="../apk/MasterKodiIL_21.3_32bit.apk" class="download-btn">×”×•×¨×“ APK</a>
                </div>
            </div>
        </div>

        <div id="windows-section" class="download-section" style="display:none;">
            <h2>ğŸ’» Windows</h2>
            <div class="download-grid">
                <div class="download-card">
                    <div class="icon">ğŸ’»</div>
                    <h3>Windows Portable</h3>
                    <p class="info">×§×•×“×™ × ×™×™×“ ×¢× Wizard ××•×‘× ×”</p>
                    <a href="#" class="download-btn" style="opacity:0.5;">×‘×§×¨×•×‘</a>
                </div>
            </div>
        </div>

        <div id="devices-section" class="download-section" style="display:none;">
            <h2>ğŸ“‹ ××™×–×• ×’×¨×¡×” ××ª××™××” ×œ×™?</h2>
            <table class="device-table">
                <tr><th>××›×©×™×¨</th><th>×’×¨×¡×”</th></tr>
                <tr><td>NVIDIA Shield (×›×œ ×”×“×’××™×)</td><td style="color:#00ff88">64-bit</td></tr>
                <tr><td>Chromecast with Google TV</td><td style="color:#00ff88">64-bit</td></tr>
                <tr><td>Amazon Fire Stick 4K / Max</td><td style="color:#00ff88">64-bit</td></tr>
                <tr><td>Amazon Fire Stick (×“×•×¨ 2-3)</td><td style="color:#ffdd00">32-bit</td></tr>
                <tr><td>Xiaomi Mi Box S</td><td style="color:#00ff88">64-bit</td></tr>
                <tr><td>Samsung Galaxy (2020+)</td><td style="color:#00ff88">64-bit</td></tr>
                <tr><td>×˜×œ×¤×•× ×™× ×™×©× ×™×</td><td style="color:#ffdd00">32-bit</td></tr>
                <tr><td>×¡×˜×¨×™××¨×™× ×¡×™× ×™×™× ×–×•×œ×™×</td><td style="color:#aaa">× ×¡×” 64, ××—×¨×ª 32</td></tr>
            </table>
        </div>
    </div>

    <script>
        function getOS(uaL) {
            if (/android/.test(uaL)) return "Android";
            if (/windows nt/.test(uaL)) return "Windows";
            if (/macintosh|mac os x/.test(uaL) && !/iphone|ipad|ipod/.test(uaL)) return "macOS";
            if (/iphone|ipad|ipod/.test(uaL)) return "iOS";
            if (/linux/.test(uaL)) return "Linux";
            return "Unknown";
        }

        function guessArchFromUA(uaL) {
            if (/(arm64|aarch64|x86_64|amd64|x64|win64|wow64)/.test(uaL)) return "64";
            if (/(i686|ia32|x86|armv7|armv6)/.test(uaL)) return "32";
            if (/armv8/.test(uaL)) return "64";
            return "unknown";
        }

        function detectAndroidDeviceName(uaL) {
            if (/shield/.test(uaL)) return "NVIDIA Shield";
            if (/aft/.test(uaL)) return "Amazon Fire TV";
            if (/mi box|mibox|xiaomi/.test(uaL)) return "Xiaomi / Mi Box";
            if (/chromecast/.test(uaL)) return "Chromecast / Google TV";
            return "Android";
        }

        function clearRecommendedBadges() {
            ["card-64", "card-32"].forEach(id => {
                const card = document.getElementById(id);
                card.classList.remove("recommended");
                const h3 = card.querySelector("h3");
                if (h3 && h3.dataset && h3.dataset.badged === "1") {
                    h3.dataset.badged = "0";
                    const lines = h3.innerHTML.split("<br>");
                    h3.textContent = (lines.length > 1) ? lines.slice(1).join(" ").trim() : h3.textContent;
                }
            });
        }

        async function detectDevice() {
            const ua = navigator.userAgent || "";
            const uaL = ua.toLowerCase();

            const os = getOS(uaL);
            let deviceLabel = os;
            let arch = guessArchFromUA(uaL); // "64" | "32" | "unknown"
            let confidence = (arch === "unknown") ? "low" : "high";

            if (navigator.userAgentData) {
                try {
                    const high = await navigator.userAgentData.getHighEntropyValues([
                        "platform",
                        "platformVersion",
                        "architecture",
                        "bitness",
                        "model"
                    ]);

                    if (high && high.bitness) {
                        if (high.bitness === "64") { arch = "64"; confidence = "high"; }
                        if (high.bitness === "32") { arch = "32"; confidence = "high"; }
                    } else if (high && high.architecture) {
                        if (/64|x86_64|arm64|aarch64/i.test(high.architecture)) { arch = "64"; confidence = "high"; }
                        else if (/x86|86|arm/i.test(high.architecture) && arch === "unknown") { arch = "32"; confidence = "medium"; }
                    }

                    if (os === "Android" && high && high.model) {
                        deviceLabel = high.model;
                    }
                } catch (e) {
                    // ignore
                }
            }

            if (os === "Android") {
                if (deviceLabel === "Android") deviceLabel = detectAndroidDeviceName(uaL);
            }

            let rec = "";
            if (os === "Android") {
                if (arch === "64") rec = "××•××œ×¥ Android 64-bit (arm64)";
                else if (arch === "32") rec = "××•××œ×¥ Android 32-bit (arm)";
                else rec = "×œ× ×”×¦×œ×—×ª×™ ×œ×–×”×•×ª 32/64 ×‘×•×•×“××•×ª. ×‘×“×¨×š ×›×œ×œ 64-bit ××ª××™× ×œ×¨×•×‘ ×”××›×©×™×¨×™×. ×× ×œ× ××ª×§×™×Ÿ â€” × ×¡×” 32-bit.";
            } else if (os === "Windows") {
                if (arch === "32") rec = "×–×•×”×” Windows 32-bit";
                else if (arch === "64") rec = "×–×•×”×” Windows 64-bit";
                else rec = "×–×•×”×” Windows, ××‘×œ 32/64 ×œ× ×‘×¨×•×¨. ×‘×¨×•×‘ ×”××§×¨×™× ×–×” 64-bit.";
            } else {
                rec = "×–×•×”×ª×” ××¢×¨×›×ª: " + os + ". ×”×¢××•×“ ×”×–×” ×›×¨×’×¢ ××¦×™×¢ Android/Windows ×‘×œ×‘×“.";
            }

            document.getElementById("detected-device").innerHTML =
                "ğŸ–¥ï¸ ×–×•×”×”: <strong>" + deviceLabel + "</strong>" +
                (arch !== "unknown" ? " â€¢ <strong>" + arch + "-bit</strong>" : "") +
                (confidence === "low" ? " â€¢ <span style='color:#ffdd00'>×–×™×”×•×™ ×œ× ×•×“××™</span>" : "");

            document.getElementById("recommendation").textContent = rec;

            clearRecommendedBadges();

            if (os === "Android") {
                const pick = (arch === "32") ? "card-32" : "card-64"; // default to 64 when unknown
                const card = document.getElementById(pick);
                card.classList.add("recommended");

                const h3 = card.querySelector("h3");
                if (h3 && h3.dataset.badged !== "1") {
                    h3.dataset.badged = "1";
                    const original = h3.textContent;
                    h3.innerHTML = '<span class="badge">××•××œ×¥</span><br>' + original;
                }
            }
        }

        function showSection(section, btn) {
            document.getElementById('android-section').style.display = section === 'android' ? 'block' : 'none';
            document.getElementById('windows-section').style.display = section === 'windows' ? 'block' : 'none';
            document.getElementById('devices-section').style.display = section === 'devices' ? 'block' : 'none';
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
        }

        detectDevice();
    </script>
</body>
</html>
